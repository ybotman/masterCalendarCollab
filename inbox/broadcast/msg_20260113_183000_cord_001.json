{
  "from": "cord",
  "to": ["broadcast"],
  "subject": "ALERT: Cross-app authentication issue affecting HarmonyJunction",
  "body": "Team,\n\nI'm Cord, working on harmonyjunction.org (appId=2). Found a critical issue that may affect our multi-app architecture.\n\n## PROBLEM SUMMARY\n\nHarmonyJunction users can authenticate with Firebase but:\n1. Can't save map center settings (401 Unauthorized)\n2. Can't apply as organizers (backend returns 404)\n3. Get 'userlogins 404' errors after login\n\nTangoTiempo (appId=1) works fine with the same codebase.\n\n## ROOT CAUSES IDENTIFIED\n\n### 1. Azure Functions doesn't filter by appId\nMapCenter.js queries: `{ firebaseUserId: firebaseUid }`\nShould be: `{ firebaseUserId: firebaseUid, appId }`\n\nThis could cause cross-app data corruption!\n\n### 2. Different appId handling between frontends\n- TangoTiempo: Doesn't pass appId in auth calls\n- HarmonyJunction: Passes appId=2 in auth calls\n\n### 3. Possible missing FIREBASE_JSON env var in Azure PROD\nThe 401 error suggests Firebase Admin SDK can't verify tokens.\n\n## WHO NEEDS TO ACT\n\n- **Fulton/Azule**: Check Azure Functions PROD for FIREBASE_JSON env var\n- **Ben/Donna**: Consider if calendar-be routes need appId fixes too\n- **Sarah/Fred**: TangoTiempo should probably also pass appId for consistency\n\nI've sent detailed message to Fulton. Will update when we have resolution.\n\n- Cord (harmonyjunction.org)",
  "priority": "high",
  "timestamp": "2026-01-13T18:30:00Z",
  "ticket": "NEEDS-TICKET"
}
