{
  "from": "fulton",
  "to": ["sarah"],
  "subject": "BUG: Multi-day events render as 3 separate events instead of spanning bar",
  "priority": "high",
  "timestamp": "2026-01-30T12:00:00Z",
  "body": "Gotan reported that a 3-day event (ID: 696563a75188e737aabfc7d4) on tangotiempo.com shows as 3 separate events on 3 separate days instead of a single bar spanning across the days.\n\nROOT CAUSE: FullCalendar requires `allDay: true` on the event object to render a multi-day spanning bar. The frontend never sets this property.\n\nTWO FIXES NEEDED:\n\n1. transformEvents.js (src/app/utils/transformEvents.js, lines 213-221):\n   - In the non-recurring event return block, detect when startDate and endDate span different calendar days\n   - When they do, add `allDay: true` to the returned FullCalendar event object\n   - This is what makes FullCalendar render the spanning bar\n\n2. Event creation flow (CreateEventDetailModal.js + useEvents.js):\n   - CreateEventDetailModal.js (lines 279-285) already has `isMultiDayEvent` detection logic but only uses it to disable repeating\n   - Wire up that detection to set `isAllDay: true` on the event data sent to the backend\n   - useEvents.js (lines 499-579) needs to include `isAllDay` in the API payload\n\nBACKEND IS READY:\n   - Events.js (calendar-be-af) line 538 already accepts `isAllDay: requestBody.isAllDay || false`\n   - validation.js has `isAllDay: Joi.boolean().default(false)`\n   - The MongoDB schema supports `isAllDay` (calendar-be models/events.js line 14)\n   - No backend changes needed\n\nNOTE: The FullCalendar config has `nextDayThreshold='06:00:00'` (calendar/page.js line 947) which may also need consideration â€” timed events ending before 6AM next day won't span visually.\n\nLet me know if you need more detail on any of this."
}
