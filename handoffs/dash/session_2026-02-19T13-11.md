# Session Handoff: Dash @ 2026-02-19

## Current Status
Enhanced Dashboard with dynamic FE/BE version display. Added heatmap button debugging. All deployed to TEST and PROD.

## Active Ticket
- **Ticket**: None specific (Dashboard enhancements)
- **Status**: completed

## What I Did This Session
- Investigated visitor heatmap time filtering issue (was working - just needed cache busting)
- Added cache-busting `&_t=timestamp` to heatmap API calls
- Added build-time env vars to next.config.mjs:
  - NEXT_PUBLIC_APP_VERSION (from package.json)
  - NEXT_PUBLIC_APP_NAME
  - NEXT_PUBLIC_BUILD_TIME
- Enhanced StatusPanel to show FE/BE versions in header bar
- StatusPanel now fetches /api/health/version for live backend info
- Added console logging to heatmap time range buttons for debugging
- Merged all changes to main, TEST, and PROD branches

## Pending Items
1. **Fulton's DQ Issue** - 13-16 events with empty masteredCityName need backfill script
2. **Activity Tracking endpoints** - awaiting Fulton's GET endpoints:
   - GET /api/analytics/login-history
   - GET /api/analytics/visitor-history
   - GET /api/analytics/mapcenter-history
3. **Firebase Users** - /api/firebase/users endpoint returns 404

## Next Session Should
1. Check inbox for new messages
2. Address masteredCityName data quality issue if prioritized
3. Verify heatmap time filtering on PROD (open console, click buttons, check logs)

## Key Decisions Made
- Used build-time env vars for FE version (set at next build, not runtime)
- Backend version fetched live from /api/health/version endpoint
- Added cache-busting to all heatmap API calls

## Context for Future Me
- Heatmap API is working correctly on PROD (tested with curl)
- Backend v1.22.0 has flexible range param: 1H, 3H, 24H, 1D, 7D, 1W, 2W, 1M, 3M, 6M, 1Yr, 2Yr, All
- If heatmap still shows same values, check browser DevTools Console for the debug logs
- CALOPS FE version is 1.2.2, BE version is 1.22.0
